<form (ngSubmit)="onSubmit()" class="event-form-container">
  <div class="form-group">
    <label for="pos">Select POS</label>
    <select
      id="pos"
      [(ngModel)]="selectedPosId"
      (change)="onPosChange()"
      name="pos"
      required
      [ngClass]="{'input-error': !selectedPosId && submitted}"
      class="custom-select"
    >
      <option *ngFor="let pos of posList" [value]="pos.posId">
        {{ pos.posName }} - {{ pos.posLocation }}
      </option>
    </select>
    <div *ngIf="!selectedPosId && submitted" class="error-message">Please select a POS.</div>
  </div>

  <div class="form-group">
    <label for="description">Description</label>
    <input
      type="text"
      id="description"
      [(ngModel)]="event.description"
      name="description"
      placeholder="Enter event description"
      required
      [ngClass]="{'input-error': !event.description && submitted}"
    />
    <div *ngIf="!event.description && submitted" class="error-message">Description is required.</div>
  </div>

  <div class="form-group">
    <label for="prestataireName">Select Prestataire</label>
    <select
      id="prestataireName"
      [(ngModel)]="event.prestataireName"
      name="prestataireName"
      class="custom-select"
      required
      [ngClass]="{'input-error': !event.prestataireName && submitted}"
    >
      <option *ngFor="let prestataire of prestataires" [value]="prestataire.userName">
        {{ prestataire.userName }}
      </option>
    </select>
    <div *ngIf="!event.prestataireName && submitted" class="error-message">Please select a prestataire.</div>
  </div>

  <div class="form-group">
    <label for="clientName">Client Name</label>
    <input
      type="text"
      id="clientName"
      [(ngModel)]="event.clientName"
      name="clientName"
      placeholder="Enter client name"
    />
  </div>

  <div class="form-group">
    <label for="eventStatus">Event Status</label>
    <select
      id="eventStatus"
      [(ngModel)]="event.eventStatus"
      name="eventStatus"
      required
      [ngClass]="{'input-error': !event.eventStatus && submitted}"
      class="custom-select"
    >
      <option value="Pending">Pending</option>
    </select>
    <div *ngIf="!event.eventStatus && submitted" class="error-message">Event status is required.</div>
  </div>

  <div class="form-group">
    <label for="service">Select Service</label>
    <select
      id="service"
      [(ngModel)]="selectedServiceId"
      name="service"
      required
      [ngClass]="{'input-error': !selectedServiceId && submitted}"
      class="custom-select"
    >
      <option *ngFor="let service of services" [value]="service.serviceId">
        {{ service.serviceName }} - {{ service.prix | currency }}
      </option>
    </select>
    <div *ngIf="!selectedServiceId && submitted" class="error-message">Please select a service.</div>
  </div>

  <div class="form-group">
    <label for="dateRequest">Event Date</label>
    <input
      type="date"
      id="dateRequest"
      [(ngModel)]="eventDate"
      name="dateRequest"
      required
      [ngClass]="{'input-error': !eventDate && submitted}"
    />
    <div *ngIf="!eventDate && submitted" class="error-message">Event date is required.</div>
  </div>

  <div class="form-group">
    <label for="timeRequest">Event Time</label>
    <input
      type="time"
      id="timeRequest"
      [(ngModel)]="eventTime"
      name="timeRequest"
    />
  </div>

  <button (click)="submitted = true; onSubmit()" type="submit" class="submit-button">
    Create Event
  </button>

  <div *ngIf="isEventSelected" class="action-buttons">
    <button type="button" class="update-button" (click)="updateEvent()">
      Update Event
    </button>
    <button type="button" class="delete-button" (click)="deleteEvent()">
      Delete Event
    </button>
  </div>

  <div *ngIf="(userRole === 'Admin' || userRole === 'Prestataire') && isEventSelected" class="button-container">
    <button type="button" class="assign-button" (click)="openPrestataireModal()">Assign Event to Prestataire</button>
    <div class="modal-overlay" *ngIf="showPrestataireModal" (click)="closePrestataireModal()"></div>
<div class="modal-content" *ngIf="showPrestataireModal">
  <button class="close-button" (click)="closePrestataireModal()">X</button>
  <h2>Select Prestataire</h2>
  <ul>
    <li *ngFor="let prestataire of prestataires">
      <button (click)="handlePrestataireSelection(prestataire.userName)">
        {{ prestataire.userName }}
      </button>
    </li>
  </ul>
</div>
  </div>
  <div *ngIf="userRole === 'Prestataire' && isEventSelected" class="button-container">
    <button type="button" class="accept-button" (click)="acceptEvent(event.id ?? 0)">
      Accept Event
    </button>
    <button type="button" class="reject-button" (click)="rejectEvent(event.id ?? 0)">
      Reject Event
    </button>
  </div>
</form>
